<div class="filtros mb-3">
    <label class="form-label">Filtrar por Especialidad:</label>
    <div class="d-flex gap-2 flex-wrap mb-2">
        <button *ngFor="let esp of especialidades()" class="btn btn-outline-primary btn-sm"
            (click)="actualizarFiltroEspecialidad(esp)">
            {{ esp }}
        </button>
        <button class="btn btn-outline-secondary btn-sm" (click)="actualizarFiltroEspecialidad('')">
            Limpiar
        </button>
    </div>

    <label class="form-label">Buscar Paciente (nombre o apellido):</label>
    <input type="text" class="form-control" [value]="filtro().filtroPaciente"
        (input)="actualizarFiltroPaciente($any($event.target).value)" placeholder="Ingrese nombre o apellido" />
</div>

<div class="lista-turnos mt-4">
    <div *ngFor="let turno of turnos().filter(cumpleFiltro)" class="card mb-3">
        <div class="card-body">
            <h5 class="card-title">{{ turno.especialidad }}</h5>
            <p class="card-text">
                <strong>Paciente:</strong> {{ turno.nombre_paciente }} {{ turno.apellido_paciente }}<br />
                <strong>Fecha:</strong> {{ turno.fecha_turno | date: 'fullDate' }}<br />
                <strong>Hora:</strong> {{ turno.hora_turno }}
            </p>
            <span class="badge bg-info text-dark">{{ turno.estado }}</span>

            <div class="mt-3" *ngIf="puedeCancelar(turno) || puedeRechazar(turno) || puedeFinalizar(turno)">
                <input type="text" class="form-control mb-2" [placeholder]="'Comentario...'"
                    (input)="actualizarComentario(turno.id!, $any($event.target).value)" />
            </div>

            <div class="d-flex flex-wrap gap-2 mt-2">
                <button *ngIf="puedeAceptar(turno)" class="btn btn-success btn-sm" (click)="aceptarTurno(turno)">
                    Aceptar
                </button>
                <button *ngIf="puedeCancelar(turno)" class="btn btn-warning btn-sm" (click)="cancelarTurno(turno)">
                    Cancelar
                </button>
                <button *ngIf="puedeRechazar(turno)" class="btn btn-danger btn-sm" (click)="rechazarTurno(turno)">
                    Rechazar
                </button>
                <button *ngIf="puedeFinalizar(turno)" class="btn btn-primary btn-sm" (click)="finalizarTurno(turno)">
                    Finalizar
                </button>
                <button *ngIf="puedeVerResena(turno)" class="btn btn-info btn-sm" disabled>
                    Ver Rese√±a
                </button>
            </div>
        </div>
    </div>
</div>